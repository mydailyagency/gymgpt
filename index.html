<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MyDailyAgency — 12‑Week Strength Program</title>
  <style>
    :root{
      --bg:#0f1115; --card:#151922; --muted:#9aa4b2; --text:#e8edf2; --acc:#6ee7b7; --acc2:#60a5fa; --warn:#fbbf24; --bad:#f87171;
      --border:#232838; --good:#34d399;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0d0f14,#0f1115 40%,#10131a);color:var(--text);font:15px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",Arial,sans-serif}
    header{position:sticky;top:0;z-index:20;background:rgba(13,15,20,.7);backdrop-filter:blur(6px);border-bottom:1px solid var(--border)}
    .wrap{max-width:1100px;margin:0 auto;padding:18px}
    h1{font-size:22px;margin:0 0 6px}
    .sub{color:var(--muted);font-size:13px}
    .grid{display:grid;gap:12px}
    .controls{grid-template-columns:repeat(12,1fr);align-items:end}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px}
    label{display:block;color:var(--muted);font-size:12px;margin-bottom:6px}
    input,select,button{background:#0c0f14;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:10px 12px;font:inherit}
    input[type=number]{width:100%}
    button{cursor:pointer}
    .btn{background:#111521;border-color:#25304a}
    .btn:hover{background:#0f1320}
    .accent{background:linear-gradient(90deg,var(--acc2),var(--acc));border:0;color:#07111a;font-weight:700}
    .accent:hover{filter:brightness(0.95)}
    .muted{color:var(--muted)}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .kpi{display:flex;align-items:center;gap:10px}
    .kpi .dot{width:10px;height:10px;border-radius:50%}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;background:#0e121a;border:1px solid var(--border);font-size:12px;color:var(--muted)}
    .danger{color:var(--bad)}
    .good{color:var(--good)}
    .tabs{display:flex;gap:6px;flex-wrap:wrap}
    .tab{padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:#0d1119;cursor:pointer}
    .tab.active{background:#142032;border-color:#2b3a55}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px dashed #242a3a;vertical-align:top}
    th{color:#aab4c2;text-align:left;font-weight:700}
    tr:hover td{background:#0f1420}
    code{background:#101522;border:1px solid #1d2a3c;padding:1px 6px;border-radius:6px}
    details{border:1px solid var(--border);border-radius:10px;padding:10px 12px;background:#101524}
    details+details{margin-top:10px}
    details summary{cursor:pointer;font-weight:700}
    footer{color:var(--muted);font-size:12px;padding:24px 0;text-align:center}
    .two{display:grid;grid-template-columns:1.2fr .8fr;gap:14px}
    @media (max-width: 900px){.controls{grid-template-columns:1fr 1fr 1fr}.two{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>MyDailyAgency — 12‑Week Strength Program</h1>
      <div class="row sub">
        <span class="pill">Goal: <strong>Max strength</strong> in Front Squat, Bench, Deadlift</span>
        <span class="pill">Method: <strong>Top‑set + Back‑offs</strong> on heavy days</span>
        <span class="pill">Frequency: each lift <strong>2×/week</strong></span>
        <span class="pill">Deloads: <strong>Weeks 4 & 8</strong></span>
      </div>
    </div>
  </header>

  <main class="wrap grid" style="margin-top:12px">
    <section class="card grid controls">
      <div style="grid-column: span 3">
        <label>Week</label>
        <select id="week"></select>
      </div>
      <div style="grid-column: span 6">
        <label>Day</label>
        <div id="days" class="tabs"></div>
      </div>
      <div style="grid-column: span 3;display:flex;gap:8px;align-items:end;justify-content:flex-end">
        <button id="printWeek" class="btn">Print current week</button>
        <button id="exportCsv" class="btn">Export week CSV</button>
      </div>

      <div class="two" style="grid-column: 1/-1">
        <div class="card" style="background:#0e131c">
          <div class="row">
            <div style="flex:1">
              <label>Front Squat 1RM (lb)</label>
              <input type="number" id="fs1rm" value="315" min="45" step="5" />
            </div>
            <div style="flex:1">
              <label>Bench Press 1RM (lb)</label>
              <input type="number" id="bp1rm" value="275" min="45" step="5" />
            </div>
            <div style="flex:1">
              <label>Deadlift 1RM (lb)</label>
              <input type="number" id="dl1rm" value="505" min="45" step="5" />
            </div>
          </div>
          <div class="row" style="margin-top:10px">
            <label class="pill"><input id="kgToggle" type="checkbox" /> Show kg too</label>
            <label class="pill"><input id="plateToggle" type="checkbox" /> Show plate math</label>
            <label class="pill"><input id="savePrefs" type="checkbox" checked /> Save settings locally</label>
          </div>
        </div>
        <div class="card" style="background:#0e131c">
          <div class="kpi"><span class="dot" style="background:var(--acc)"></span> Heavy day = **top set** (RPE ~8–9) + **2–3 back‑offs ~−3%**</div>
          <div class="kpi"><span class="dot" style="background:var(--acc2)"></span> Light/volume days: speed/technique or moderate reps @ RPE 6–8</div>
          <div class="kpi"><span class="dot" style="background:var(--warn)"></span> Deload weeks 4 & 8: cut volume ~50%, intensity −5–10%</div>
          <div class="kpi"><span class="dot" style="background:var(--good)"></span> Autoregulate: if bar speed slow, hold or −2–5 lb; if snappy, +2.5–5 lb</div>
        </div>
      </div>
    </section>

    <section id="dayCard" class="card">
      <h2 style="margin:0 0 8px">Session Plan</h2>
      <div class="muted" id="sessionIntro" style="margin-bottom:10px"></div>
      <table>
        <thead>
          <tr>
            <th style="width:22%">Exercise</th>
            <th style="width:16%">Sets × Reps</th>
            <th style="width:14%">%1RM</th>
            <th style="width:18%">Target Load</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </section>

    <section class="two">
      <section class="card">
        <h3 style="margin-top:0">Block Roadmap</h3>
        <ul class="muted">
          <li><strong>Block 1 (Weeks 1–4):</strong> Build & Groove — heavy triples, speed pulls; Week 4 deload.</li>
          <li><strong>Block 2 (Weeks 5–8):</strong> Intensify — heavier triples/doubles; Week 8 deload.</li>
          <li><strong>Block 3 (Weeks 9–12):</strong> Realize — practice singles @ ~90–93% + back‑offs; Week 12 conservative test.</li>
        </ul>
        <details><summary>Autoregulation (RPE/RIR)</summary>
          <p>Most main‑lift work sets at <strong>RPE 7–9</strong> (leave 1–3 reps in reserve). If warm‑ups feel heavy/slow, hold last week’s load or reduce 2–5 lb. If bar speed is great, add 2.5–5 lb. Stop sets the moment technique degrades.</p>
        </details>
        <details><summary>Warm‑up (10–12 min)</summary>
          <ul>
            <li>2–3 min breathing/bracing (90/90 or crocodile breaths)</li>
            <li>3–4 min hips/ankles/scaps (leg swings, ankle rocks, band pull‑aparts)</li>
            <li>3–5 quick ramp sets to first work set (e.g., 30%, 50%, 70%)</li>
          </ul>
        </details>
        <details><summary>Low‑back hygiene</summary>
          <ul>
            <li>Use bench‑supported rows; neutral spine on leg press; brace on all hinges.</li>
            <li>Optional belt on heavy doubles/triples.</li>
            <li>If low back is “hot” after Day 3, <strong>skip Day‑5 Snatch‑RDL</strong> that week.</li>
          </ul>
        </details>
      </section>

      <section class="card">
        <h3 style="margin-top:0">Recovery & Nutrition (strength multipliers)</h3>
        <ul>
          <li><strong>Sleep:</strong> Aim 7–8 h nightly. If not possible, 20–30 min nap on training days.</li>
          <li><strong>Protein:</strong> Keep <strong>160–180 g/day</strong> (3–5 feedings of 30–50 g incl. pre/post).</li>
          <li><strong>Calories:</strong> For strength + slight hypertrophy, add <strong>+200–300 kcal</strong> (mostly carbs) on training days; if BW & lifts stall 2+ weeks, add +100–150 kcal.</li>
          <li><strong>Pre‑lift (60–120 min):</strong> 30–60 g carbs + 20–40 g protein + ~500 ml water + 1–2 g sodium. Optional caffeine only on heavy days.</li>
          <li><strong>Creatine:</strong> 5 g/day.</li>
          <li><strong>Hydration:</strong> Keep urine pale straw; sip during long sessions.</li>
        </ul>
      </section>
    </section>

    <section class="card">
      <h3 style="margin-top:0">Coach Notes</h3>
      <ul class="muted">
        <li>Heavy day exposure (top set) sharpens skill at high intensity; back‑offs build quality volume without junk fatigue.</li>
        <li>Speed/paused deadlifts provide a second pull that builds positions & bar speed while protecting the spine.</li>
        <li>Accessories are dosed to grow quads, hams, lats, triceps, and delts <em>without</em> stealing recovery from the next heavy day.</li>
        <li>On bench Day 6, alternate <strong>Close‑Grip</strong> vs <strong>Dips</strong> as the primary accessory weekly.</li>
        <li>Week 12 “test” is conservative (RPE 8.5–9); use back‑off AMRAPs only if reps are clean.</li>
      </ul>
    </section>

    <footer>Built for you by MyDailyAgency. Copy this file, save as <code>index.html</code>, and open in your browser.</footer>
  </main>

  <script>
    // -------- Helpers
    const $ = (q) => document.querySelector(q);
    const tbody = $('#tbody');
    const weekSel = $('#week');
    const daysEl = $('#days');
    const sessionIntro = $('#sessionIntro');

    const round5 = (x) => Math.round(x/5)*5;
    const lbToKg = (lb) => Math.round(lb*0.45359237);

    function platesFor(load, bar=45){
      if(!load || load < bar) return [];
      let perSide = (load - bar)/2;
      const plates=[45,25,10,5,2.5];
      const out=[];
      for(const p of plates){
        let n = Math.floor((perSide+1e-6)/p);
        if(n>0){ out.push(`${n}×${p}`); perSide -= n*p; }
      }
      return out;
    }

    function saveState(){
      if(!$('#savePrefs').checked) return;
      const s={
        fs:+$('#fs1rm').value||315,
        bp:+$('#bp1rm').value||275,
        dl:+$('#dl1rm').value||505,
        week:+weekSel.value||1,
        day: +document.querySelector('.tab.active')?.dataset.day || 1,
        kg: $('#kgToggle').checked,
        plates: $('#plateToggle').checked,
      };
      localStorage.setItem('mda12', JSON.stringify(s));
    }
    function loadState(){
      try{ const s=JSON.parse(localStorage.getItem('mda12')||'{}');
        if(s.fs) $('#fs1rm').value=s.fs;
        if(s.bp) $('#bp1rm').value=s.bp;
        if(s.dl) $('#dl1rm').value=s.dl;
        if(s.kg) $('#kgToggle').checked=true;
        if(s.plates) $('#plateToggle').checked=true;
        return s;
      }catch(e){return{}};
    }

    // -------- Program logic (Top+Backoff recommended)
    const isDeload = (w)=> w===4 || w===8;

    function dayPlan(week, day){
      const fs1 = +$('#fs1rm').value||315;
      const bp1 = +$('#bp1rm').value||275;
      const dl1 = +$('#dl1rm').value||505;
      const odd = (week%2)===1; // for CGBP vs Dips primary on Day 6
      const showKg = $('#kgToggle').checked;
      const showPlates = $('#plateToggle').checked;

      const rows=[];
      let intro="";

      function main(ex, sets, pct, oneRM, notes=""){
        const load = round5(pct*oneRM);
        const kg = lbToKg(load);
        const plateTxt = showPlates ? ` — plates/side: ${platesFor(load).join(', ')||'—'}` : '';
        rows.push({ex, sets, pct:`${(pct*100).toFixed(1)}%`, load: showKg? `${load} lb (${kg} kg)` : `${load} lb`, notes: notes+plateTxt});
      }
      function mainNoPct(ex, sets, pctStr, loadLb, notes=""){
        const load = round5(loadLb);
        const kg = lbToKg(load);
        const plateTxt = $('#plateToggle').checked ? ` — plates/side: ${platesFor(load).join(', ')||'—'}` : '';
        rows.push({ex, sets, pct:pctStr, load: $('#kgToggle').checked? `${load} lb (${kg} kg)` : `${load} lb`, notes: notes+plateTxt});
      }
      function acc(ex, sets, notes=""){
        rows.push({ex, sets, pct:"", load:"", notes});
      }

      // Accessory templates
      const ACC = {
        D1: isDeload(week) ? [
          ['Snatch‑Grip RDL','1–2×6','RPE ≤6–7 (deload)'],
          ['Bulgarian Split Squat','1–2×8/leg','RPE ≤6–7'],
          ['Pull‑Ups','2×6–8','RPE ≤6–7'],
          ['Cable Crunch','2×12–15','—'],
        ] : [
          ['Snatch‑Grip RDL','2×6','RPE 6–7 (straps OK)'],
          ['Bulgarian Split Squat','2×8/leg','RPE 7'],
          ['Pull‑Ups','3×8','RIR 1–2 (add weight if easy)'],
          ['Cable Crunch','3×15','—'],
        ],
        D2: isDeload(week) ? [
          ['Close‑Grip Bench','1–2×6–8','RPE ≤6–7'],
          ['Dips','1–2×8','RPE ≤6–7 (shoulder‑friendly depth)'],
          ['Cable Lateral Raise','2×12–15','RPE ≤6–7'],
          ['Rear Delt Fly','2×12–15','RPE ≤6–7'],
          ['Leg Raises','2×15–20','Controlled'],
        ] : [
          ['Close‑Grip Bench','2–3×6–8','RPE 7–8'],
          ['Dips','2×8','RIR 1–2 (shoulder‑friendly depth)'],
          ['Cable Lateral Raise','3×15','RIR 0–2'],
          ['Rear Delt Fly','2–3×15','RIR 0–2'],
          ['Leg Raises','3×20–30','Controlled'],
        ],
        D3: isDeload(week) ? [
          ['Shrugs','1–2×10–12','RPE ≤6–7'],
          ['Leg Press','1–2×8','RPE ≤6–7 (neutral spine)'],
          ['DB Row (Bench‑Supported)','2×8–10','RPE ≤6–7'],
          ['Lying Ham Curl','2×10','RPE ≤6–7'],
          ['Cable Crunch','2×12–15','—'],
        ] : [
          ['Shrugs','2–3×12','RIR 1–2'],
          ['Leg Press','2–3×8','RIR 1–2 (neutral spine)'],
          ['DB Row (Bench‑Supported)','3×10–12','RIR 1–2'],
          ['Lying Ham Curl','3×10–12','RIR 0–2'],
          ['Cable Crunch','3×15','—'],
        ],
        D5: isDeload(week) ? [
          ['Snatch‑Grip RDL','1–2×8','RPE ≤6–7 (skip if back hot)'],
          ['Bulgarian Split Squat','1–2×8/leg','RPE ≤6–7'],
          ['Pull‑Ups','2×6–8','RPE ≤6–7'],
          ['Cable Crunch','2×12–15','—'],
        ] : [
          ['Snatch‑Grip RDL','2–3×8','RPE 6–7 (skip if low back hot)'],
          ['Bulgarian Split Squat','2–3×8/leg','RPE 7–8'],
          ['Pull‑Ups','3×8','RIR 1–2'],
          ['Cable Crunch','3×15','—'],
        ],
        D6: isDeload(week) ? [
          ['Close‑Grip Bench OR Dips','2×8–10','RPE ≤6–7 (alternate weekly)'],
          ['Cable Lateral Raise','2×12–15','RPE ≤6–7'],
          ['Rear Delt Fly','2×12–15','RPE ≤6–7'],
          ['Leg Raises','2×15–20','Controlled'],
        ] : (odd ? [
          ['Close‑Grip Bench (Primary)','3×8–10','RPE 7–8'],
          ['Dips (Secondary)','2×8','RIR 1–2'],
          ['Cable Lateral Raise','3×15','RIR 0–2'],
          ['Rear Delt Fly','2–3×15','RIR 0–2'],
          ['Leg Raises','3×20–30','—'],
        ] : [
          ['Dips (Primary)','3×8–10','RIR 1–2'],
          ['Close‑Grip Bench (Secondary)','2×8','RPE 7–8'],
          ['Cable Lateral Raise','3×15','RIR 0–2'],
          ['Rear Delt Fly','2–3×15','RIR 0–2'],
          ['Leg Raises','3×20–30','—'],
        ]),
        D7: isDeload(week) ? [
          ['Shrugs','1–2×12–15','RPE ≤6–7'],
          ['Leg Press','2×8–10','RPE ≤6–7'],
          ['DB Row (Bench‑Supported)','2×8–10','RPE ≤6–7'],
          ['Lying Ham Curl','2×10–12','RPE ≤6–7'],
          ['Cable Crunch','2×12–15','—'],
        ] : [
          ['Shrugs','2–3×15','RIR 1–2'],
          ['Leg Press','3×10','RIR 1–2 (neutral spine)'],
          ['DB Row (Bench‑Supported)','3×10–12','RIR 1–2'],
          ['Lying Ham Curl','2–3×12','RIR 0–2'],
          ['Cable Crunch','3×15','—'],
        ],
      };

      // Main lift prescriptions by week/day
      const W = week;
      switch(day){
        case 1: // Front Squat heavy
          if(W<=3){ main('Front Squat (Top Set)','1×3', [0.82,0.84,0.86][W-1], fs1,'RPE ~8–9'); main('Front Squat (Back‑Off)','2–3×3', [0.82,0.84,0.86][W-1]-0.03, fs1,'≈ −3% from top'); }
          else if(W===4){ main('Front Squat','2–3×3',0.75,fs1,'DELOAD'); }
          else if(W<=7){ const arr=[0.85,0.865,0.88]; const p=arr[W-5]; main('Front Squat (Top Set)','1×3',p,fs1,'RPE ~8–9'); main('Front Squat (Back‑Off)','2–3×3',p-0.03,fs1,'≈ −3% from top'); }
          else if(W===8){ main('Front Squat','2–3×2–3',0.78,fs1,'DELOAD'); }
          else if(W<=11){ const single=[0.90,0.92,0.93][W-9]; const bo=[0.86,0.87,0.88][W-9]; main('Front Squat (Single)','1×1',single,fs1,'RPE ~8–8.5'); main('Front Squat (Back‑Off)','3×2–3',bo,fs1,''); }
          else { main('Front Squat (Top Single)','1×1',0.93,fs1,'RPE ~8.5–9'); main('Front Squat (Back‑Off)','1–2×2–3',0.85,fs1,''); }
          ACC.D1.forEach(([e,s,n])=>acc(e,s,n));
          intro = 'Heavy front‑squat exposure (top set) then controlled back‑offs. Accessories build quads/lats/core without stealing recovery.';
          break;
        case 2: // Bench heavy
          if(W<=3){ main('Bench Press (Top Set)','1×3', [0.84,0.86,0.88][W-1], bp1,'RPE ~8–9'); main('Bench Press (Back‑Off)','2–3×3', [0.84,0.86,0.88][W-1]-0.03, bp1,'≈ −3% from top'); }
          else if(W===4){ main('Bench Press','2–3×3',0.78,bp1,'DELOAD'); }
          else if(W<=7){ const arr=[0.86,0.88,0.90]; const p=arr[W-5]; main('Bench Press (Top Set)','1×3',p,bp1,'RPE ~8–9'); main('Bench Press (Back‑Off)','2–3×3',p-0.03,bp1,'≈ −3% from top'); }
          else if(W===8){ main('Bench Press','2–3×2–3',0.80,bp1,'DELOAD'); }
          else if(W<=11){ const single=[0.90,0.92,0.93][W-9]; const bo=[0.86,0.87,0.88][W-9]; main('Bench Press (Single)','1×1',single,bp1,'RPE ~8–8.5'); main('Bench Press (Back‑Off)','3×2–3',bo,bp1,''); }
          else { main('Bench Press (Top Single)','1×1',0.93,bp1,'RPE ~8.5–9'); main('Bench Press (Back‑Off)','1–2×2–3',0.85,bp1,''); }
          ACC.D2.forEach(([e,s,n])=>acc(e,s,n));
          intro = 'Heavy bench exposure then triceps/shoulder hypertrophy. Keep dip depth shoulder‑friendly.';
          break;
        case 3: // Deadlift heavy
          if(W<=3){ main('Deadlift (Top Set)','1×3', [0.82,0.84,0.86][W-1], dl1,'RPE ~8–9'); main('Deadlift (Back‑Off)','2×3', [0.82,0.84,0.86][W-1]-0.03, dl1,'≈ −3% from top'); }
          else if(W===4){ main('Deadlift','2×3',0.75,dl1,'DELOAD'); }
          else if(W<=7){ const arr=[0.85,0.875,0.90]; const p=arr[W-5]; main('Deadlift (Top Set)','1×2',p,dl1,'RPE ~8–9'); main('Deadlift (Back‑Off)','2×2',p-0.03,dl1,'≈ −3% from top'); }
          else if(W===8){ main('Deadlift','2×2',0.78,dl1,'DELOAD'); }
          else if(W<=11){ const single=[0.90,0.92,0.93][W-9]; const bo=[0.86,0.87,0.88][W-9]; main('Deadlift (Single)','1×1',single,dl1,'RPE ~8–8.5'); main('Deadlift (Back‑Off)','2–3×2',bo,dl1,''); }
          else { main('Deadlift (Top Single)','1×1',0.93,dl1,'RPE ~8.5–9'); main('Deadlift (Back‑Off)','1–2×2–3',0.85,dl1,''); }
          ACC.D3.forEach(([e,s,n])=>acc(e,s,n));
          intro = 'Heavy pull day with tight set caps. Rows supported to unload lumbar; ham curls for hamstring size without systemic fatigue.';
          break;
        case 4:
          rows.push({ex:'REST / Recovery', sets:'—', pct:'', load:'', notes:'Mobility + easy walk; sleep & carbs; optional light stretching'});
          intro = 'Full rest. This day makes the next 3 sessions better. Prioritize sleep and carbs.';
          break;
        case 5: // Front Squat light/volume
          if(W<=3){ main('Front Squat','3–4×4–5', [0.70,0.72,0.75][W-1], fs1,'Speed/technique focus'); }
          else if(W===4){ main('Front Squat','2–3×3–4', 0.68, fs1,'DELOAD, technique'); }
          else if(W<=7){ main('Front Squat','3–4×3–4', [0.72,0.75,0.78][W-5], fs1,'Speed/technique focus'); }
          else if(W===8){ main('Front Squat','2–3×3', 0.70, fs1,'DELOAD, technique'); }
          else if(W<=11){ main('Front Squat','3×3', [0.72,0.74,0.76][W-9], fs1,'Speed/technique focus'); }
          else { main('Front Squat (Light)','2×3', 0.70, fs1,'Very light, technique'); }
          ACC.D5.forEach(([e,s,n])=>acc(e,s,n));
          intro = 'Technique and hypertrophy without frying CNS. Skip RDLs if low back is hot.';
          break;
        case 6: // Bench volume
          if(W<=3){ main('Bench Press','3–4×5–6', [0.75,0.78,0.80][W-1], bp1,'RPE 7–8'); }
          else if(W===4){ main('Bench Press','2–3×3–4', 0.74, bp1,'DELOAD'); }
          else if(W<=7){ main('Bench Press','3–4×4–5', [0.78,0.80,0.82][W-5], bp1,'RPE 7–8'); }
          else if(W===8){ main('Bench Press','2–3×3–4', 0.74, bp1,'DELOAD'); }
          else if(W<=11){ main('Bench Press','3×4–5', [0.78,0.80,0.82][W-9], bp1,'RPE 7–8'); }
          else { main('Bench Press (Light)','2×3–4', 0.72, bp1,'Very light, technique'); }
          ACC.D6.forEach(([e,s,n])=>acc(e,s,n));
          intro = 'Volume bench for groove and size. Alternate CGBP vs Dips as the primary each week.';
          break;
        case 7: // Deadlift speed/technique
          if(W<=3){ main('Deadlift (Speed)','5–6×2', [0.60,0.64,0.68][W-1], dl1,'FAST, 90–120s rest'); }
          else if(W===4){ main('Deadlift (Speed)','4×2', 0.60, dl1,'DELOAD, crisp'); }
          else if(W<=7){ main('Deadlift (Speed)','6×2', [0.65,0.68,0.70][W-5], dl1,'FAST, 90–120s rest'); }
          else if(W===8){ main('Deadlift (Speed)','4×2', 0.60, dl1,'DELOAD, crisp'); }
          else if(W<=11){ main('Deadlift (Speed)','5×2', [0.65,0.68,0.70][W-9], dl1,'FAST, 90–120s rest'); }
          else { main('Deadlift (Speed)','3×2', 0.60, dl1,'Very light'); }
          ACC.D7.forEach(([e,s,n])=>acc(e,s,n));
          intro = 'Speed or paused pulls sharpen start position and rate of force without hammering your back.';
          break;
      }

      return {rows,intro};
    }

    function render(){
      const week = +weekSel.value;
      const day = +document.querySelector('.tab.active')?.dataset.day || 1;
      const {rows,intro} = dayPlan(week, day);
      sessionIntro.textContent = `Week ${week} · Day ${day} — ${intro}`;
      tbody.innerHTML = rows.map(r=>`<tr>
        <td><strong>${r.ex}</strong></td>
        <td>${r.sets}</td>
        <td>${r.pct||''}</td>
        <td>${r.load||''}</td>
        <td class="muted">${r.notes||''}</td>
      </tr>`).join('');
      saveState();
    }

    // Build week/day controls
    function init(){
      for(let w=1; w<=12; w++){ const o=document.createElement('option'); o.value=w; o.textContent = `Week ${w}${(w===4||w===8)?' (Deload)':''}`; weekSel.appendChild(o);}    
      for(let d=1; d<=7; d++){ const b=document.createElement('button'); b.className='tab'+(d===1?' active':''); b.dataset.day=d; b.textContent = (d===4? 'Day 4 · REST' : `Day ${d}`); daysEl.appendChild(b);}    
      const s = loadState();
      if(s.week) weekSel.value = s.week;
      if(s.day){ document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active')); const t=document.querySelector(`.tab[data-day="${s.day}"]`); if(t) t.classList.add('active'); }
      render();
    }

    weekSel.addEventListener('change', render);
    daysEl.addEventListener('click', (e)=>{ if(e.target.classList.contains('tab')){ document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active')); e.target.classList.add('active'); render(); }});
    ['fs1rm','bp1rm','dl1rm','kgToggle','plateToggle','savePrefs'].forEach(id=> $("#"+id).addEventListener('input', render));

    // Print & CSV
    $('#printWeek').addEventListener('click', ()=> window.print());
    $('#exportCsv').addEventListener('click', ()=>{
      const week = +weekSel.value;
      let csv = 'Week,Day,Exercise,Sets x Reps,%1RM,Target Load,Notes\n';
      for(let d=1; d<=7; d++){
        const {rows} = dayPlan(week,d);
        rows.forEach(r=>{
          const line = [week,d,`"${r.ex}"`,`"${r.sets}"`,r.pct||'',`"${r.load||''}"`, `"${(r.notes||'').replaceAll('"','\"')}"`].join(',');
          csv += line+'\n';
        });
      }
      const blob = new Blob([csv],{type:'text/csv'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=`MDA_Week${week}.csv`; a.click();
    });

    init();
  </script>
</body>
</html>
